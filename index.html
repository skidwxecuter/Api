<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Redirect Site Maker</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 40px auto; }
    input, button { padding: 10px; margin: 5px 0; width: 100%; }
    button { cursor: pointer; }
    #result { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Redirect Site Maker</h1>

  <label>Target URL:</label>
  <input type="url" id="targetUrl" placeholder="https://example.com">

  <label>Custom Site Name (optional):</label>
  <input type="text" id="siteName" placeholder="my-custom-redirect">

  <label>Page Title (optional):</label>
  <input type="text" id="pageTitle" placeholder="Redirecting to Example">

  <button onclick="createRedirect()">Create Redirect Site</button>

  <div id="result"></div>

  <script>
    function isValidUrl(string) {
      try {
        new URL(string);
        return true;
      } catch (_) {
        return false;  
      }
    }

    async function createRedirect() {
      const targetUrl = document.getElementById('targetUrl').value.trim();
      const siteName = document.getElementById('siteName').value.trim();
      const pageTitle = document.getElementById('pageTitle').value.trim();

      const result = document.getElementById('result');
      result.innerHTML = '';

      if (!isValidUrl(targetUrl)) {
        result.innerHTML = '❌ Invalid URL. Please enter a valid URL starting with http:// or https://';
        return;
      }

      result.innerHTML = '⏳ Creating site, please wait...';

      try {
        const response = await fetch('https://YOUR_RENDER_BACKEND_URL/create-redirect', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ targetUrl, siteName, pageTitle })
        });

        const data = await response.json();

        if (data.siteUrl) {
          result.innerHTML = `
            ✅ Site created!<br>
            <a href="${data.siteUrl}" target="_blank">${data.siteUrl}</a>
          `;
        } else {
          result.innerHTML = `❌ Error: ${JSON.stringify(data)}`;
        }

      } catch (err) {
        result.innerHTML = '❌ Something went wrong: ' + err;
      }
    }
  </script>
</body>
</html>
