<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Global Posts</title>
  <style>
    body {
      background: #111;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
      text-align: center;
    }
    input, textarea {
      width: 90%;
      padding: 10px;
      margin: 10px 0;
      font-size: 16px;
    }
    button {
      background: #0f0;
      color: #000;
      padding: 10px 30px;
      font-size: 18px;
      cursor: pointer;
      border: none;
      border-radius: 8px;
      margin-top: 10px;
    }
    .post {
      border: 1px solid #0f0;
      margin: 20px 0;
      padding: 20px;
      text-align: left;
    }
    video, iframe {
      max-width: 100%;
      height: auto;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h1>üì¢ Create a Post</h1>
  <input id="postTitle" placeholder="Title (required)"><br>
  <textarea id="postDescription" placeholder="Description (required)" rows="4"></textarea><br>
  <input id="videoURL" placeholder="Video URL (optional)"><br>
  <p>OR Upload Video File (optional):</p>
  <input type="file" id="videoFile" accept="video/*"><br>
  <button onclick="createPost()">Create Post</button>

  <h1>üåç Global Posts</h1>
  <div id="posts"></div>

  <script>
    // Load posts from localStorage
    let posts = JSON.parse(localStorage.getItem('globalPosts') || '[]');

    function createPost() {
      const title = document.getElementById('postTitle').value.trim();
      const desc = document.getElementById('postDescription').value.trim();
      const url = document.getElementById('videoURL').value.trim();
      const fileInput = document.getElementById('videoFile');
      const file = fileInput.files[0];

      if (!title || !desc) {
        alert('Title and Description are required.');
        return;
      }

      let video = '';
      if (url) {
        video = url;
        savePost(title, desc, video);
      } else if (file) {
        // Read file as DataURL
        const reader = new FileReader();
        reader.onload = function(e) {
          video = e.target.result; // base64
          savePost(title, desc, video);
        }
        reader.readAsDataURL(file);
      } else {
        savePost(title, desc, '');
      }
    }

    function savePost(title, desc, video) {
      const newPost = { title, desc, video };
      posts.push(newPost);
      localStorage.setItem('globalPosts', JSON.stringify(posts));
      renderPosts();
      clearForm();
    }

    function renderPosts() {
      const postsDiv = document.getElementById('posts');
      postsDiv.innerHTML = '';
      posts.slice().reverse().forEach(p => {
        const postEl = document.createElement('div');
        postEl.className = 'post';
        postEl.innerHTML = `<h2>${p.title}</h2>
          <p>${p.desc}</p>`;
        if (p.video) {
          if (p.video.startsWith('http')) {
            postEl.innerHTML += `<iframe src="${p.video}" frameborder="0" allowfullscreen></iframe>`;
          } else {
            postEl.innerHTML += `<video controls src="${p.video}"></video>`;
          }
        }
        postsDiv.appendChild(postEl);
      });
    }

    function clearForm() {
      document.getElementById('postTitle').value = '';
      document.getElementById('postDescription').value = '';
      document.getElementById('videoURL').value = '';
      document.getElementById('videoFile').value = '';
    }

    renderPosts();
  </script>

</body>
</html>
